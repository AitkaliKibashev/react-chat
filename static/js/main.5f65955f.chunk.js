(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{59:function(e,t,n){},79:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t),n.d(t,"Context",(function(){return B})),n.d(t,"TempUserContext",(function(){return z}));var a=n(1),c=n(15),r=n.n(c),o=(n(79),n(18)),s=(n(59),n(39)),i=n.n(s),l=n(47),j=n(121),u=n(124),d=n(125),h=n(126),b=n(132),x=n(32),O="/login",m="/chat/:roomId?",p=n(31),f=n(7),g=function(){var e=Object(a.useContext)(B).auth,t=Object(p.a)(e),n=Object(o.a)(t,1)[0],c=Object(a.useContext)(z);return Object(f.jsx)(j.a,{position:"static",children:Object(f.jsxs)(u.a,{children:[Object(f.jsx)(d.a,{variant:"h6",children:n||c.user.displayName?"Chat":"Home"}),Object(f.jsx)(h.a,{container:!0,justifyContent:"flex-end",children:n||c.user.displayName?Object(f.jsx)(x.b,{to:O,style:{textDecoration:"none"},children:Object(f.jsx)(b.a,{onClick:function(){if(n)return Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.signOut();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));localStorage.clear()},variant:"contained",color:"secondary",children:"Logout"})}):Object(f.jsx)(x.b,{to:O,style:{textDecoration:"none"},children:Object(f.jsx)(b.a,{variant:"contained",color:"secondary",children:"Login"})})})]})})},y=n(17),v=n(127),w=n(131),C=n(129),_=n(28),I=function(){var e=Object(a.useContext)(B).auth,t=Object(a.useState)(""),n=Object(o.a)(t,2),c=n[0],r=n[1],s=function(){var t=Object(l.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new _.a.auth.GoogleAuthProvider).addScope("https://www.googleapis.com/auth/contacts.readonly"),t.next=4,e.signInWithRedirect(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(f.jsx)(v.a,{children:Object(f.jsx)(h.a,{container:!0,style:{height:window.innerHeight-65},alignItems:"center",justifyContent:"center",children:Object(f.jsx)(h.a,{style:{width:400,background:"lightgray"},container:!0,justifyContent:"center",alignItems:"center",children:Object(f.jsxs)(w.a,{p:5,style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(f.jsx)(b.a,{onClick:s,variant:"outlined",children:"Login with Google"}),Object(f.jsx)("p",{style:{margin:"10px 0"},children:"Or log in as a temporary user"}),Object(f.jsxs)("div",{className:"temp-user-block",children:[Object(f.jsx)(C.a,{value:c,onChange:function(e){return r(e.target.value)},rowsMax:2,variant:"outlined",color:"secondary",label:"Name",style:{width:"70%"},size:"small"}),Object(f.jsx)(b.a,{onClick:function(){localStorage.setItem("name",c),localStorage.setItem("uid",toString(Math.floor(1e3*Math.random(1e3)))),window.location.reload(),r("")},variant:"outlined",color:"secondary",children:"Go"})]})]})})})})},N=n(133),S=n(56),k=n(128),A=function(){return Object(f.jsx)(v.a,{children:Object(f.jsx)(h.a,{container:!0,style:{height:window.innerHeight},alignItems:"center",justifyContent:"center",children:Object(f.jsx)(h.a,{container:!0,justifyContent:"center",alignItems:"center",children:Object(f.jsx)(k.a,{})})})})},R=Object(y.g)((function(e){var t=e.match,n=Object(a.useState)(""),c=Object(o.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)(""),l=Object(o.a)(i,2),j=l[0],u=l[1],d=Object(a.useContext)(B),O=d.auth,m=d.firestore,g=Object(a.useContext)(z),y=Object(p.a)(O),w=Object(o.a)(y,1)[0],I=w||g.user,k=t.params.roomId,R=Object(S.a)(m.collection("messages").orderBy("createdAt")),L=Object(o.a)(R,1)[0],M=Object(S.a)(m.collection("rooms").orderBy("createdAt")),T=Object(o.a)(M,2),D=T[0],H=T[1],U=Object(a.useRef)(null);Object(a.useEffect)((function(){console.log("YO"),U.current&&(U.current.scrollTop=U.current.scrollHeight,console.log(U.current.scrollTop))}),[L]);return H?Object(f.jsx)(A,{}):Object(f.jsxs)(v.a,{children:[Object(f.jsx)("h1",{style:{marginTop:10},children:"Welcome to the my fucking CHAT"}),Object(f.jsxs)("div",{className:"chat-row",children:[Object(f.jsxs)("div",{style:{flex:1},className:"chat-row__chat-list",children:[Object(f.jsx)("h1",{children:"Rooms"}),Object(f.jsx)("div",{style:{flex:1},children:D?D.map((function(e){return Object(f.jsx)(x.b,{style:{textDecoration:"none"},to:"/chat/"+e.id,children:Object(f.jsx)("p",{className:"chat-row__chat-list__item",children:e.name})},e.id)})):null}),Object(f.jsxs)("form",{className:"chat-row__chat-list__footer",children:[Object(f.jsx)(C.a,{value:j,onChange:function(e){return u(e.target.value)},rowsMax:2,variant:"outlined",color:"secondary",label:"Room name",style:{width:"65%"}}),Object(f.jsx)(b.a,{type:"submit",onClick:function(){if(!j)return null;m.collection("rooms").add({id:Math.floor(1e3*Math.random()),uid:I.uid,name:j,createdAt:_.a.firestore.FieldValue.serverTimestamp()}),u("")},variant:"outlined",color:"secondary",children:"Create"})]})]}),Object(f.jsxs)("div",{className:"chat-row__chat-window",children:[Object(f.jsx)("div",{className:"chat-row__chat-window__chat",ref:U,children:L?L.map((function(e){return k===e.roomId?Object(f.jsxs)("div",{className:e.uid===I.uid?"chat-row__chat-window__user-message-me":"chat-row__chat-window__user-message-other",children:[Object(f.jsxs)(h.a,{container:!0,alignItems:"center",children:[Object(f.jsx)(N.a,{src:e.photoURL,style:{marginRight:10}}),Object(f.jsx)("p",{children:e.displayName})]}),Object(f.jsx)("p",{style:{marginTop:5},children:e.text})]}):null})):null}),k?Object(f.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),!r)return null;var t=I.uid,n=I.displayName,a=I.photoURL;m.collection("messages").add({roomId:k,uid:t,displayName:n,photoURL:a,text:r,createdAt:_.a.firestore.FieldValue.serverTimestamp()}),s("")},className:"chat-row__chat-window__footer",children:[Object(f.jsx)(C.a,{value:r,onChange:function(e){return s(e.target.value)},rowsMax:2,variant:"outlined",label:"Your text",style:{width:"90%"}}),Object(f.jsx)(b.a,{type:"submit",variant:"outlined",color:"secondary",children:"Send"})]}):null]})]})]})})),L=[{path:O,Component:I}],M=[{path:m,Component:R}],T=function(){var e=Object(a.useContext)(B).auth,t=Object(a.useContext)(z),n=Object(p.a)(e);return Object(o.a)(n,1)[0]||t.user.displayName?Object(f.jsxs)(y.d,{children:[M.map((function(e){var t=e.path,n=e.Component;return Object(f.jsx)(y.b,{path:t,component:n,exact:!0},t)})),Object(f.jsx)(y.a,{to:m})]}):Object(f.jsxs)(y.d,{children:[L.map((function(e){var t=e.path,n=e.Component;return Object(f.jsx)(y.b,{path:t,component:n,exact:!0},t)})),Object(f.jsx)(y.a,{to:O})]})};var D=function(){var e=Object(a.useContext)(B).auth,t=Object(p.a)(e),n=Object(o.a)(t,3),c=(n[0],n[1]);return n[2],c?Object(f.jsx)(A,{}):Object(f.jsxs)(x.a,{children:[Object(f.jsx)(g,{}),Object(f.jsx)(T,{})]})};n(93),n(94);_.a.initializeApp({apiKey:"AIzaSyBpbPMLFA7wExzyxphf30ppEJusYv2dd_c",authDomain:"react-chat-66a99.firebaseapp.com",projectId:"react-chat-66a99",storageBucket:"react-chat-66a99.appspot.com",messagingSenderId:"918040955507",appId:"1:918040955507:web:90e31caec7d66d7eab3806"});var B=Object(a.createContext)(null),H=_.a.auth(),U=_.a.firestore(),z=Object(a.createContext)(null),E={user:{uid:localStorage.getItem("uid"),displayName:localStorage.getItem("name"),photoURL:"https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_1280.png"}};r.a.render(Object(f.jsx)(B.Provider,{value:{firebase:_.a,auth:H,firestore:U},children:Object(f.jsx)(z.Provider,{value:E,children:Object(f.jsx)(D,{})})}),document.getElementById("root"))}},[[95,1,2]]]);
//# sourceMappingURL=main.5f65955f.chunk.js.map